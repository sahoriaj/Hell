<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Episode Post Generator</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; max-width: 700px; margin: auto; }
    label { display: block; margin-top: 10px; font-weight: bold; }
    input { width: 100%; padding: 8px; margin-top: 5px; border-radius: 5px; border: 1px solid #ccc; }
    button { margin-top: 15px; padding: 10px 15px; background: #2b6cb0; color: white; border: none; border-radius: 5px; cursor: pointer; }
    button:hover { background: #2c5282; }
    pre { background: #f4f4f4; padding: 10px; border-radius: 5px; margin-top: 15px; white-space: pre-wrap; word-wrap: break-word; }
    #copyBtn { background: #38a169; margin-left: 10px; }
    #copyBtn:hover { background: #2f855a; }
    .btn-group { display: flex; gap: 10px; margin-top: 10px; flex-wrap: wrap; }
    .server-block { border: 1px solid #ddd; padding: 10px; margin-top: 10px; border-radius: 5px; }
  </style>
</head>
<body>
  <h2>Episode Post Generator</h2>
  
  <label>Thumbnail URL:</label>
  <input type="text" id="thumb" placeholder="https://example.com/thumb.jpg">

  <h3>Servers</h3>
  <div id="servers"></div>
  <button type="button" onclick="addServer()">+ Add Server</button>

  <label>Download Link (optional):</label>
  <input type="text" id="download" placeholder="https://example.com/download OR #">

  <div class="btn-group">
    <button onclick="generateCode()">Generate Code</button>
    <button id="copyBtn" onclick="copyCode()">Copy Code</button>
  </div>

  <h3>Generated Code:</h3>
  <pre id="output"></pre>

  <script>
    let serverCount = 0;

    function addServer() {
      serverCount++;
      const serversDiv = document.getElementById("servers");

      const block = document.createElement("div");
      block.className = "server-block";
      block.innerHTML = `
        <label>Server ${serverCount} Name:</label>
        <input type="text" id="serverName${serverCount}" placeholder="e.g. Server ${serverCount}">
        <label>Server ${serverCount} Embed URL:</label>
        <input type="text" id="serverUrl${serverCount}" placeholder="https://example.com/embed${serverCount}">
      `;
      serversDiv.appendChild(block);
    }

    function generateCode() {
      const thumb = document.getElementById("thumb").value.trim();
      const download = document.getElementById("download").value.trim() || "#";

      let options = `<option value="">Select Video Server</option>\n`;
      let firstServerUrl = "";

      for (let i = 1; i <= serverCount; i++) {
        const name = document.getElementById("serverName" + i).value.trim() || `Server ${i}`;
        const url = document.getElementById("serverUrl" + i).value.trim();
        if (url) {
          if (!firstServerUrl) firstServerUrl = url;
          const defaultAttr = (i === 1) ? " id='servDefault'" : "";
          options += `  <option${defaultAttr} value="${url}">${name}</option>\n`;
        }
      }

      if (!firstServerUrl) {
        alert("Please add at least one server with a valid embed URL.");
        return;
      }

      const code = `<div style="text-align: justify;">
<!-- [Thumbnail] -->
<div class="separator">
<img src="${thumb}" />
</div>

<!-- [Streaming] -->
<div id='box-movie'>
<div class="bixbox streaming">
<div class="tvideo" id="plv">
<div id="content">
<iframe src="${firstServerUrl}" frameborder="0" allowfullscreen="yes" width="100%" height="100%"></iframe>
</div>
</div>
<div class="item video-nav">
<div class="mobius"> 
 <select id='selectServ' class="selectServ" onchange="loadMi(this)" name="selectServ">
${options.trim()}
 </select>
<div class="iconx">
<a class="download" href="${download}"><div class="icol"><i class="fa fa-cloud-download" aria-hidden="true"></i> <span>Download</span></div></a>
<div class="icol light"><a class="pls" href="javascript:void(0);"><i class="fa fa-lightbulb-o" aria-hidden="true"></i> <span>Turn Off Light</span></a></div>
</div>
</div>
</div>
</div>
</div>`;

      document.getElementById("output").textContent = code;
    }

    function copyCode() {
      const output = document.getElementById("output").textContent;
      if (!output.trim()) {
        alert("Please generate code first.");
        return;
      }
      navigator.clipboard.writeText(output).then(() => {
        alert("Code copied to clipboard!");
      }).catch(err => {
        alert("Failed to copy. Please copy manually.");
      });
    }

    // Add 1 server field by default
    addServer();
  </script>
</body>
</html>
